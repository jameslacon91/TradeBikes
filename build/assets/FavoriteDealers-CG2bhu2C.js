import{c as v,u as R,a as T,b as E,r as f,d as A,e as C,j as e,C as K,f as Q,g as $,B as r,P as S,h as I,S as d,X as _,i as B,I as O,k as D}from"./index-BpSmGhpl.js";import{A as F,a as L,b as k}from"./avatar-C2h3vRl_.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=v("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=v("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=v("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Z=()=>{const{user:i}=R(),{toast:c}=T(),j=E(),[x,h]=f.useState(!1),[p,y]=f.useState(!1),[l,N]=f.useState(""),{data:g=[],isLoading:M}=A({queryKey:["/api/dealers"],enabled:!!i}),{data:t=[],isLoading:q}=A({queryKey:["/api/user/favorites"],enabled:!!i}),b=M||q,z=C({mutationFn:async s=>{await D("POST","/api/user/favorites/add",{dealerId:s})},onSuccess:()=>{j.invalidateQueries({queryKey:["/api/user/favorites"]}),c({title:"Added to favorites",description:"Dealer has been added to your favorites"})},onError:()=>{c({title:"Action failed",description:"Could not add dealer to favorites.",variant:"destructive"})},onSettled:()=>{h(!1)}}),P=C({mutationFn:async s=>{await D("POST","/api/user/favorites/remove",{dealerId:s})},onSuccess:()=>{j.invalidateQueries({queryKey:["/api/user/favorites"]}),c({title:"Removed from favorites",description:"Dealer has been removed from your favorites"})},onError:()=>{c({title:"Action failed",description:"Could not remove dealer from favorites.",variant:"destructive"})},onSettled:()=>{h(!1)}}),w=s=>{if(!i)return;h(!0),t.some(n=>n.id===s)?P.mutate(s):z.mutate(s)},u=()=>{if(!Array.isArray(g)||!Array.isArray(t)||!i)return[];const s=g.filter(a=>a.id!==i.id&&!t.some(n=>n.id===a.id));return l?s.filter(a=>a.companyName&&a.companyName.toLowerCase().includes(l.toLowerCase())||a.username.toLowerCase().includes(l.toLowerCase())):s};return e.jsxs(K,{children:[e.jsxs(Q,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs($,{className:"text-xl font-semibold flex items-center",children:[e.jsx(m,{className:"mr-2 h-5 w-5 text-yellow-500"}),"Favorite Dealers"]}),e.jsxs(r,{variant:"outline",size:"sm",className:"h-8 px-2 lg:flex gap-1",disabled:x||b,onClick:()=>y(s=>!s),children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Add Dealer"})]})]}),e.jsx(I,{children:b?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(d,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{children:[e.jsx(d,{className:"h-4 w-32 mb-1"}),e.jsx(d,{className:"h-3 w-24"})]})]}),e.jsx(d,{className:"h-8 w-8 rounded-full"})]},a))}):t.length===0||p?e.jsxs("div",{className:"py-4",children:[t.length===0?e.jsx("p",{className:"text-muted-foreground mb-4 text-center",children:"You don't have any favorite dealers yet."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-medium text-sm",children:"Add More Dealers"}),e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>{y(!1),N("")},children:[e.jsx(_,{className:"h-4 w-4 mr-1"})," Close"]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search dealers by name...",value:l,onChange:s=>N(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[p&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-sm",children:"Available Dealers:"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[u().length," found"]})]}),u().length===0?e.jsx("p",{className:"text-center text-muted-foreground text-sm py-2",children:l?"No dealers match your search":"No more dealers available"}):e.jsx(e.Fragment,{children:u().map(s=>{var a;return e.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(F,{children:[e.jsx(L,{children:((a=s.companyName)==null?void 0:a[0])||s.username[0]}),e.jsx(k,{src:`https://api.dicebear.com/7.x/initials/svg?seed=${s.companyName||s.username}`})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.companyName||s.username}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("div",{className:"flex items-center mr-3",children:[...Array(5)].map((n,o)=>e.jsx(m,{className:`h-3 w-3 ${o<(s.rating||0)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},o))}),e.jsxs("span",{children:[s.totalRatings," ratings"]})]})]})]}),e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>w(s.id),disabled:x,children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," Add"]})]},s.id)})})]})]}):e.jsx("div",{className:"space-y-4",children:t.map(s=>{var a;return e.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(F,{children:[e.jsx(L,{children:((a=s.companyName)==null?void 0:a[0])||s.username[0]}),e.jsx(k,{src:`https://api.dicebear.com/7.x/initials/svg?seed=${s.companyName||s.username}`})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.companyName||s.username}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("div",{className:"flex items-center mr-3",children:[...Array(5)].map((n,o)=>e.jsx(m,{className:`h-3 w-3 ${o<(s.rating||0)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},o))}),e.jsxs("span",{children:[s.totalRatings," ratings"]})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"ghost",size:"icon",title:"Remove from favorites",onClick:()=>w(s.id),disabled:x,children:e.jsx(m,{className:"h-4 w-4 fill-yellow-500 text-yellow-500"})}),e.jsx(r,{variant:"ghost",size:"icon",title:"Message",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(r,{variant:"ghost",size:"icon",title:"Call",children:e.jsx(H,{className:"h-4 w-4"})})]})]},s.id)})})})]})};export{Z as default};
